import randomimport asyncioimport websocketsimport win32com.client# Create ObjectinstMarketEye = win32com.client.Dispatch("CpSysDib.MarketEye")instCpCodeMgr = win32com.client.Dispatch("CpUtil.CpCodeMgr")# realtime loginstCpConclusion = win32com.client.Dispatch("Dscbo1.CpConclusion")instCpConclusion.Subscribe();async def temp():    # SetInputValue    instMarketEye.SetInputValue(0, (4, 67, 70, 111))    instMarketEye.SetInputValue(1, 'A003540')    # BlockRequest    instMarketEye.BlockRequest()    # GetData    await websocket.send('현재가 :' + str(instMarketEye.GetDataValue(0, 0)))    await websocket.send('PER :' + str(instMarketEye.GetDataValue(1, 0)))    await websocket.send('EPS :' + str(instMarketEye.GetDataValue(2, 0)))    await websocket.send('최근분기년월 :' + str(instMarketEye.GetDataValue(3, 0)))async def sendRealtimelog(websocket, path):    codeList = instCpCodeMgr.GetStockListByMarket(1)    for i, code in enumerate(codeList):        if i % 2 == 0 and i < 100:            secondCode = instCpCodeMgr.GetStockSectionKind(code)            name = instCpCodeMgr.CodeToName(code)            print(i, code, secondCode, name)            message = str(i) + ', ' + str(code) + ', ' + str(secondCode) + ', ' + name            await websocket.send(message)async def main(websocket, path):    name = await websocket.recv()    print(f"{name}")    send = asyncio.ensure_future(sendMsg(websocket, path))    print("main asyncio start")    asyncio.as_completed((send))# 웹 소켓 서버 생성.호스트는 localhost에 port는 9998로 생성한다.start_server = websockets.serve(main, "172.30.1.41", 9998)# 비동기로 서버를 대기한다.asyncio.get_event_loop().run_until_complete(start_server)asyncio.get_event_loop().run_forever()